<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>杖劍傳說 素材計算機</title>

  <!-- Tailwind 僅供本地/測試用；正式可改為編譯後 CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet" />

  <!-- 自訂樣式 -->
  <link rel="stylesheet" href="./css/style.css" type="text/css" />

</head>

<body class="p-4 lg:p-6 compact">
  <div class="w-full max-w-7xl mx-auto">
    <!-- ===== 頁首 ===== -->
    <header class="text-center mb-6">
      <h1 class="text-3xl md:text-4xl font-bold">杖劍傳說 素材計算機</h1>
    </header>
    
    <!-- 賽季選項 -->
    <div class="text-center mb-6">
      <label for="season-select" class="mr-2 font-semibold">賽季選項:</label>
      <select id="season-select" class="input-field rounded p-2">
        <!-- JS 會動態插入賽季選項 -->
      </select>
      <label for="server-select" class="mr-2 font-semibold">伺服器：</label>
      <!-- 將由 JS 動態填入選項 -->
      <select id="server-select" class="input-field rounded p-2 w-[180px]">
        <!-- 動態選項 -->
      </select>
    </div>

    <!-- ===== 目標時間 / 現在時間 ===== -->
    <div class="card rounded-lg p-4 shadow-lg mb-6 w-full">
      <!-- 外層兩欄，滿版 -->
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <!-- 左：目標時間 -->
        <div>
          <h3 class="text-lg font-semibold mb-2">目標時間</h3>

          <!-- 橫向滿版：select 固定寬，右側 flex-1 -->
          <div class="flex flex-col lg:flex-row lg:items-center gap-3 w-full">
            <!-- 下拉：固定寬 -->
            <select id="target-time-preset" class="input-field rounded p-2 w-[180px]"></select>

            <!-- 唯讀時間條：吃滿剩餘寬度 -->
            <div id="target-time-display"
                class="flex-1 text-center bg-gray-900/50 p-2 rounded h-[42px] flex items-center justify-center text-[#e2e8f0]">
              --
            </div>

            <!-- 自訂輸入：與上面時間條同高同寬（預設隱藏） -->
            <input type="datetime-local" id="target-time-custom"
                  class="input-field rounded p-2 h-[42px] flex-1 hidden" />

            <!-- 實際運算值 -->
            <input type="hidden" id="target-time" />
          </div>
        </div>

        <!-- 右：現在時間（滿版） -->
        <div>
          <h3 class="text-lg font-semibold mb-2">現在時間</h3>
          <div id="current-time-display"
              class="text-center bg-gray-900/50 p-2 rounded h-[42px] flex items-center justify-center text-[#e2e8f0] w-full">
          </div>
        </div>
      </div>

    </div>

    <!-- 原初之星 -->
    <div class="card rounded-lg p-4 shadow-lg mb-4 w-full">
      <h3 class="text-xl font-bold text-center mb-4">原初之星 (累計)</h3>
      <div id="primordial-star-cumulative" class=""></div> <!-- class 先留空，JS 會加 -->
    </div>

    
    
    <!-- 目標等級（共鳴） -->
    <div class="card rounded-lg p-4 shadow-lg mb-4 w-full">
      <h3 class="text-xl font-bold text-center mb-4">目標等級 (共鳴)</h3>
      <div id="target-levels" class=""></div> <!-- class 先留空，JS 會加 -->
    </div>
    
    <!-- 遺物分佈 -->
    <div class="card rounded-lg p-4 shadow-lg mb-6 w-full">
      <h3 class="text-xl font-bold text-center mb-4">
        遺物等級分佈 <span id="relic-total-display" class="text-sm font-normal text-gray-400">(0/20)</span>
      </h3>
      <div id="relic-distribution-inputs" class="grid grid-cols-2 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-12 gap-4"></div>
    </div>
    
    <!-- ===== 三欄主內容 ===== -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-4"><!-- gap-6 → gap-4 -->
      <!-- 左：角色 + 技能 -->
      <div class="lg:max-h-[75vh] lg:flex lg:flex-col lg:gap-4"><!-- gap-6 → gap-4 -->
        <!-- 角色與床（加長） -->
      <div class="card rounded-xl p-0 shadow-lg lg:flex-[1.1] flex flex-col min-h-0">
        <h2 class="text-2xl font-bold border-b sticky top-0 z-10 px-4 py-2 m-0 bg-white/90 backdrop-blur border-[#cde5e8]">
          角色經驗
        </h2>
        <div class="overflow-y-auto custom-scrollbar p-4 min-h-0">
          <div id="char-bed-inputs" class="space-y-3"></div>
        </div>
        <div class="flex flex-wrap items-center justify-center gap-4 mb-3">
          <label for="notify-time-select" class="font-semibold">升級通知提前時間:</label>
          <select id="notify-time-select" class="input-field rounded p-2">
            <option value="min0">升級時</option>
            <option value="min1">1 分鐘</option>
            <option value="min2">2 分鐘</option>
            <option value="min3" selected>3 分鐘</option>
            <option value="min5">5 分鐘</option>
          </select>
        </div>
        <div class="flex flex-wrap items-center justify-center gap-4 mb-3">
          <button id="enable-levelup-notify-btn"
            class="bg-gray-600 hover:bg-gray-500 text-white font-bold py-2 px-4 rounded-lg text-xs">
            啟用升級通知
          </button>
          <button id="disable-notify-btn"
            class="bg-gray-600 hover:bg-gray-500 text-white font-bold py-2 px-4 rounded-lg text-xs">
            清除升級通知
          </button>
        </div>
      </div>
        
      
        <div class="card rounded-xl p-0 shadow-lg lg:flex-1 flex flex-col min-h-0">
          <h2 class="text-2xl font-bold border-b sticky top-0 z-10 px-4 py-2 m-0 bg-white/90 backdrop-blur border-[#cde5e8]">
            技能等級
          </h2>
          <div class="overflow-y-auto custom-scrollbar p-4 min-h-0">
            <div id="skill-inputs" class="space-y-4"></div>
          </div>
        </div>
      </div>
    
    <!-- 中：角色 + 幻獸 + 小推車 -->
    <div class="lg:max-h-[75vh] lg:flex lg:flex-col lg:gap-4">
      <div class="card rounded-xl p-0 shadow-lg lg:flex-1 flex flex-col min-h-0">
          <h2 class="text-2xl font-bold border-b sticky top-0 z-10 px-4 py-2 m-0 bg-white/90 backdrop-blur border-[#cde5e8]">
            裝備等級
          </h2>
          <div class="overflow-y-auto custom-scrollbar p-4 min-h-0"><!-- p-6 → p-4 -->
            <div id="equip-inputs" class="space-y-4"></div><!-- 保持 -->
          </div>
        </div>
    
      <!-- 幻獸等級（縮短） -->
      <div class="card rounded-xl p-0 shadow-lg lg:flex-[0.5] flex flex-col min-h-0">
        <h2 class="text-2xl font-bold border-b sticky top-0 z-10 px-4 py-2 m-0 bg-white/90 backdrop-blur border-[#cde5e8]">
          幻獸等級
        </h2>
        <div class="overflow-y-auto custom-scrollbar p-4 min-h-0">
          <div id="pet-inputs" class="space-y-3"></div>
        </div>
      </div>
    
      <!-- 小推車（微調） -->
      <div class="card rounded-xl p-0 shadow-lg lg:flex-[1.2] flex flex-col min-h-0">
        <h2 class="text-2xl font-bold border-b sticky top-0 z-10 px-4 py-2 m-0 bg-white/90 backdrop-blur border-[#cde5e8]">
          小推車
        </h2>
        <div class="overflow-y-auto custom-scrollbar p-4 min-h-0">
          <div id="production-inputs" class="space-y-4 mb-4"></div>
        </div>
      </div>
    </div>
   

    
    
    <!-- 右：素材資訊 + 計算總覽（等高對齊） -->
    <div class="lg:max-h-[75vh] lg:flex lg:flex-col lg:gap-4">
      <!-- 素材資訊（縮短） -->
      <div class="card rounded-xl p-0 shadow-lg lg:flex-[0.75] flex flex-col min-h-0">
        <h2 class="text-2xl font-bold border-b pb-3 sticky top-0 z-10 px-6 py-3 m-0 bg-white/90 backdrop-blur border-[#cde5e8]">
          目前持有素材
        </h2>
        <div class="overflow-y-auto custom-scrollbar p-4 min-h-0">
          <div id="owned-materials" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-1 gap-3"></div>
        </div>
      </div>
    
      <!-- 計算總覽（拉長） -->
      <div class="card rounded-xl p-0 shadow-lg lg:flex-[1.25] flex flex-col min-h-0">
        <h2 class="text-2xl font-bold border-b pb-3 sticky top-0 z-10 px-6 py-3 m-0 bg-white/90 backdrop-blur border-[#cde5e8]">
          計算總覽
        </h2>
        <div class="overflow-y-auto custom-scrollbar p-4 min-h-0">
          <div id="results" class="space-y-3 pt-2"></div>
        </div>
      </div>
    </div>
  </div>
  <!-- 素材來源估算（由 view.js 動態渲染內容） -->
  <div class="card rounded-lg p-4 shadow-lg mb-6 w-full">
    <div id="material-source-container"></div>
  </div>
  
  <!-- ===== 底部：功能按鈕 ===== -->
  <footer class="col-span-full w-full mt-10">
    <div class="max-w-7xl mx-auto px-4
                flex flex-col items-center justify-center text-center text-gray-500 text-sm">
      <div class="flex flex-wrap items-center justify-center gap-4 mb-3">
        <button id="clear-local-data-btn"
          class="bg-red-800 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg text-xs">
          清除本地紀錄
        </button>
      </div>
      <p class="max-w-2xl leading-relaxed">
        本計算機為非官方工具，僅供玩家參考使用。網頁製作：菲亞。資料來源：ななや、六歲、羽菟o、夜奈喵。
      </p>
      <p class="mt-2">
        GitHub Repo：
        <a href="https://github.com/sophie8909/sxstx_calculator"> 
          https://github.com/sophie8909/sxstx_calculator
        </a>
      </p>
      <p class="mt-2"> 🥤請我喝杯奶茶
        <a href="https://buymeacoffee.com/sophie8909" target="_blank">buymeacoffee.com/sophie8909</a>
        🥤
      </p>
    </div>
  </footer>
  <!-- 入口點（控制器） -->
  <script type="module" src="./js/controller.js"></script>
</body>

</html>